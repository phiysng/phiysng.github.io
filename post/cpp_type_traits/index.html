<!DOCTYPE html>
<html lang="cn">
<head>
<meta charset="UTF-8">
<title>Cpp_type_traits | phiysng</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.101.0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="wysho">
<meta name="keywords" content="cpp, type traits">
<meta name="description" content="Dr Brown的CppCon的讲座的笔记">
<link rel="stylesheet" type="text/css" media="screen" href="/css/normalize.css" />
<link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
<link rel="stylesheet" type="text/css" media="screen" href="/css/all.css" /><link rel="stylesheet" href="/css/katex.css" crossorigin="anonymous">
<script defer src="/js/katex.js"  integrity="sha384-PFWG8XW41D5NzhNv5FegM1CUkw9nNLdWug8DuwnUoNEVop9n5frjcnbtsZtxTNjw" crossorigin="anonymous"></script>
<script defer src="/js/auto-render.js" integrity="sha384-EN2q+JG5/3Z8gD7hT5WZqq+W+9wQR4P3IezfuZmGG5RkNXaaaks85seDJO7WkZlY" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script>
document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, { delimiters: [ {left: "$$", right: "$$", display: true}, {left: "$", right: "$", display: false} ] }); });
</script>




<meta property="og:title" content="Cpp_type_traits" />
<meta property="og:description" content="Dr Brown的CppCon的讲座的笔记" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://phiysng.github.io/post/cpp_type_traits/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-08-14T16:25:18+08:00" />
<meta property="article:modified_time" content="2022-08-14T16:25:18+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cpp_type_traits"/>
<meta name="twitter:description" content="Dr Brown的CppCon的讲座的笔记"/>

<meta itemprop="name" content="Cpp_type_traits">
<meta itemprop="description" content="Dr Brown的CppCon的讲座的笔记"><meta itemprop="datePublished" content="2022-08-14T16:25:18+08:00" />
<meta itemprop="dateModified" content="2022-08-14T16:25:18+08:00" />
<meta itemprop="wordCount" content="747">
<meta itemprop="keywords" content="cpp,type traits," />
</head>
<body>
<header>
<div id="avatar">
<a href="https://phiysng.github.io"><img src="/img/vitae.jpg" alt="phiysng"></a>
</div>
<div id="titletext">
<h2 id="title"><a href="https://phiysng.github.io">phiysng</a></h2>
</div>
<div id="title-description">
<p id="subtitle"><a href="https://github.com/dataCobra/hugo-vitae" target="_blank">Vitae</a> is a blog theme for Hugo that focuses on your content.</p>
<div id="social">
<nav><ul>
<li><a href="https://github.com/phiysng"><i title="Github" class="icons fab fa-github"></i></a></li>
<li><a><i title="Switch Dark Mode" class="dark-mode icons fas fa-moon"></i></a></li>
</ul></nav>
</div>
</div>
<div id="mainmenu">
<nav>
<ul>
<li><a href="/">Home</a></li>
<li><a href="/post">All Posts</a></li>
<li><a href="/about">About</a></li>
<li><a href="/tags">Tags</a></li>
<li><a href="/categories">Categories</a></li>
</ul>
</nav>
</div>
</header>
<main>
<div class="post">
<article>
<div class="post-header">
<div class="meta">
<div class="date">
<span class="day">14</span>
<span class="rest">Aug 2022</span>
</div>
</div>
<div class="matter">
<h1 class="title">Cpp_type_traits</h1>
<p class="post-meta">
<span class="post-meta">



</span>

</p>
</div>
</div>
<div class="markdown">
<h1 id="c的类型特征type-traits">C++的类型特征(type traits)</h1>
<h2 id="cppcon">CppCon</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888">/// template meta programming
</span></span></span><span style="display:flex;"><span><span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-weight:bold">namespace</span> tpl {
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">int</span> N<span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">abs</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">static</span> <span style="color:#080;font-weight:bold">constexpr</span> <span style="color:#339;font-weight:bold">int</span> value <span style="color:#333">=</span> N <span style="color:#333">&lt;</span> <span style="color:#00d;font-weight:bold">0</span> <span style="color:#333">?</span> (<span style="color:#333">-</span>N) <span style="color:#333">:</span> N;
</span></span><span style="display:flex;"><span>	};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span> <span style="color:#339;font-weight:bold">unsigned</span> M, <span style="color:#339;font-weight:bold">unsigned</span> N<span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">gcd</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">int</span> <span style="color:#080;font-weight:bold">const</span> value <span style="color:#333">=</span> gcd<span style="color:#333">&lt;</span>N, M<span style="color:#333">%</span> N<span style="color:#333">&gt;::</span>value;
</span></span><span style="display:flex;"><span>	};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// partial specialized version gcd(M,0) = M
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">unsigned</span> M<span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">gcd</span><span style="color:#333">&lt;</span> M, <span style="color:#00d;font-weight:bold">0</span><span style="color:#333">&gt;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">static_assert</span>(M <span style="color:#333">!=</span> <span style="color:#00d;font-weight:bold">0</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">int</span> <span style="color:#080;font-weight:bold">const</span> value <span style="color:#333">=</span> M;
</span></span><span style="display:flex;"><span>	};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// rank base condition.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// take A type and return a value.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">rank</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">static</span> size_t <span style="color:#080;font-weight:bold">const</span> value <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0u</span>;
</span></span><span style="display:flex;"><span>	};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">U</span>, size_t N<span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">rank</span><span style="color:#333">&lt;</span>U[N]<span style="color:#333">&gt;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">static</span> size_t <span style="color:#080;font-weight:bold">const</span> value <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">1u</span> <span style="color:#333">+</span> rank<span style="color:#333">&lt;</span>U<span style="color:#333">&gt;::</span>value;
</span></span><span style="display:flex;"><span>	};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// remove const from input type.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// consume a type and give a type back.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">remove_const</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">using</span> type <span style="color:#333">=</span> T;
</span></span><span style="display:flex;"><span>	};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">U</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">remove_const</span><span style="color:#333">&lt;</span>U <span style="color:#080;font-weight:bold">const</span><span style="color:#333">&gt;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">using</span> type <span style="color:#333">=</span> U;
</span></span><span style="display:flex;"><span>	};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// @link https://www.youtube.com/watch?v=Am2is2QCvxY
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// template meta programming convention.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// type result =&gt; type
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// value =&gt; value
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">typename</span> T<span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">type_is</span> { <span style="color:#080;font-weight:bold">using</span> type <span style="color:#333">=</span> T; };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// primary template handles types that are not volatile-qualified.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">remove_volatile</span> <span style="color:#333">:</span> type_is<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// partial specialization recognizes volatile-qualified types.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;U&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">U</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">remove_volatile</span><span style="color:#333">&lt;</span>U <span style="color:#080;font-weight:bold">volatile</span><span style="color:#333">&gt;</span> <span style="color:#333">:</span>type_is<span style="color:#333">&lt;</span>U<span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// conditional return type from two of them.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">bool</span> p, <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span>, <span style="color:#080;font-weight:bold">class</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">IF</span> <span style="color:#333">:</span> type_is<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span>, <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">P0</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">IF</span><span style="color:#333">&lt;</span><span style="color:#007020">false</span>, T, P0<span style="color:#333">&gt;</span> <span style="color:#333">:</span> type_is<span style="color:#333">&lt;</span>P0<span style="color:#333">&gt;</span> { };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">///
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// SFINE
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// if these step produce well-formed code
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// 
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// primary template assume the bool value is true.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// the void type is essential.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">bool</span>, <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span> <span style="color:#333">=</span> <span style="color:#339;font-weight:bold">void</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">enanle_if</span> <span style="color:#333">:</span> type_is<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// no member named type
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">enanle_if</span><span style="color:#333">&lt;</span><span style="color:#007020">false</span>, T<span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">///
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// type trait and concept&#39;s relationship.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">///
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">namespace</span> rank_revised {
</span></span><span style="display:flex;"><span>		<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// primary template handle scalar(non-array) types as base case.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">rank</span> <span style="color:#333">:</span> integral_constant<span style="color:#333">&lt;</span>size_t, <span style="color:#00d;font-weight:bold">0u</span><span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// partial specialization recognizes bounded array types.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;typeparam name=&#34;U&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">U</span>, size_t N<span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">rank</span><span style="color:#333">&lt;</span>U[N]<span style="color:#333">&gt;</span> <span style="color:#333">:</span> integral_constant<span style="color:#333">&lt;</span>size_t, <span style="color:#00d;font-weight:bold">1u</span> <span style="color:#333">+</span> rank<span style="color:#333">&lt;</span>U<span style="color:#333">&gt;::</span>value<span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// partial specialization recognizes unbounded array types.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;typeparam name=&#34;U&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">U</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">rank</span><span style="color:#333">&lt;</span>U[]<span style="color:#333">&gt;</span> <span style="color:#333">:</span> integral_constant<span style="color:#333">&lt;</span>size_t, <span style="color:#00d;font-weight:bold">1u</span> <span style="color:#333">+</span> rank<span style="color:#333">&lt;</span>U<span style="color:#333">&gt;::</span>value<span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">bool</span> b<span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">using</span> bool_constant <span style="color:#333">=</span> integral_constant<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">bool</span>, b<span style="color:#333">&gt;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">using</span> true_type <span style="color:#333">=</span> bool_constant<span style="color:#333">&lt;</span><span style="color:#007020">true</span><span style="color:#333">&gt;::</span>type;
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">using</span> false_type <span style="color:#333">=</span> bool_constant<span style="color:#333">&lt;</span><span style="color:#007020">false</span><span style="color:#333">&gt;::</span>type;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// @link https://www.youtube.com/watch?v=a0FliKwcwXE
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">namespace</span> is_void_imp1_v1 {
</span></span><span style="display:flex;"><span>		<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// primary template for non-void types.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// default assume type is not void type.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span> <span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_void</span> <span style="color:#333">:</span> false_type {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// partial specialization recognizes each of the four void types.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;&gt;</span> <span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_void</span><span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">void</span><span style="color:#333">&gt;</span> <span style="color:#333">:</span> true_type {};
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;&gt;</span> <span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_void</span><span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">void</span> <span style="color:#080;font-weight:bold">const</span><span style="color:#333">&gt;</span> <span style="color:#333">:</span> true_type {};
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// primary template for distinct types.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;U&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span>, <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">U</span><span style="color:#333">&gt;</span> <span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_same</span> <span style="color:#333">:</span> false_type {};
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// partial specialization recognizes identical types.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;T&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span> <span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_same</span><span style="color:#333">&lt;</span>T, T<span style="color:#333">&gt;</span> <span style="color:#333">:</span> true_type {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">using</span> remove_cv <span style="color:#333">=</span> remove_volatile<span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">typename</span> remove_const<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;::</span>type<span style="color:#333">&gt;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">using</span> remove_cv_t <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">typename</span> remove_cv<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;::</span>type;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">namespace</span> is_void_imp1_v2 {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">using</span> is_void <span style="color:#333">=</span> is_same<span style="color:#333">&lt;</span>remove_cv_t<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;</span>, <span style="color:#339;font-weight:bold">void</span><span style="color:#333">&gt;</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span>, <span style="color:#080;font-weight:bold">class</span><span style="color:#f00;background-color:#faa">... </span><span style="color:#b06;font-weight:bold">P0toN</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_one_of</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_one_of</span><span style="color:#333">&lt;</span>T<span style="color:#333">&gt;</span> <span style="color:#333">:</span> false_type {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span>, <span style="color:#080;font-weight:bold">class</span><span style="color:#f00;background-color:#faa">... </span><span style="color:#b06;font-weight:bold">P1toPN</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_one_of</span><span style="color:#333">&lt;</span>T, T, P1toPN...<span style="color:#333">&gt;</span> <span style="color:#333">:</span> true_type {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span>, <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">P0</span>, <span style="color:#080;font-weight:bold">class</span><span style="color:#f00;background-color:#faa">... </span><span style="color:#b06;font-weight:bold">P1toPN</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_one_of</span><span style="color:#333">&lt;</span>T, P0, P1toPN...<span style="color:#333">&gt;</span> <span style="color:#333">:</span> is_one_of<span style="color:#333">&lt;</span>T, P1toPN...<span style="color:#333">&gt;</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">namespace</span> is_void_imp1_v3 {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">using</span> is_void <span style="color:#333">=</span> is_one_of<span style="color:#333">&lt;</span>T
</span></span><span style="display:flex;"><span>			, <span style="color:#339;font-weight:bold">void</span>
</span></span><span style="display:flex;"><span>			, <span style="color:#339;font-weight:bold">void</span> <span style="color:#080;font-weight:bold">const</span>
</span></span><span style="display:flex;"><span>			, <span style="color:#339;font-weight:bold">void</span> <span style="color:#080;font-weight:bold">volatile</span>
</span></span><span style="display:flex;"><span>			, <span style="color:#339;font-weight:bold">void</span> <span style="color:#080;font-weight:bold">const</span> <span style="color:#080;font-weight:bold">volatile</span>
</span></span><span style="display:flex;"><span>		<span style="color:#333">&gt;</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// decltype &amp;&amp; is_copy_assignable
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">struct</span> <span style="color:#b06;font-weight:bold">is_coppy_assignable</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">private</span><span style="color:#333">:</span>
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">U</span>, <span style="color:#080;font-weight:bold">class</span> <span style="color:#f00;background-color:#faa">= </span><span style="color:#b06;font-weight:bold">decltype</span>(declval<span style="color:#333">&lt;</span>U<span style="color:#333">&amp;&gt;</span>() <span style="color:#333">=</span> declval<span style="color:#333">&lt;</span>U <span style="color:#080;font-weight:bold">const</span><span style="color:#333">&amp;&gt;</span>())<span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">static</span> true_type try_assignment(U<span style="color:#333">&amp;&amp;</span>); <span style="color:#888">// SFINAE may apply!
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>		<span style="color:#080;font-weight:bold">static</span> false_type <span style="color:#06b;font-weight:bold">try_assignment</span>(...); <span style="color:#888">//catch-all overload
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">public</span><span style="color:#333">:</span>
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">using</span> type <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">decltype</span>(try_assignment(declval<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;</span>()));
</span></span><span style="display:flex;"><span>	};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#888">/// &lt;summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// give whatever type and discard it all.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;/summary&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#888">/// &lt;typeparam name=&#34;...&#34;&gt;&lt;/typeparam&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span><span style="color:#f00;background-color:#faa">...</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">using</span> void_t <span style="color:#333">=</span> <span style="color:#339;font-weight:bold">void</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#579">#if 0</span><span style="color:#888">
</span></span></span><span style="display:flex;"><span><span style="color:#888">	// work around CWG 1558
</span></span></span><span style="display:flex;"><span><span style="color:#888">	template&lt;class...&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888">	struct voider { using type = void; };
</span></span></span><span style="display:flex;"><span><span style="color:#888">
</span></span></span><span style="display:flex;"><span><span style="color:#888">	template&lt;class... T0toN&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#888">	using void_t = typename voider&lt;T0toN&gt;::type;
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#579">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#579"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888">// TODO: 这里不使用enable_if_t的话，需要添加额外的typename 才可以编译成功
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#080;font-weight:bold">namespace</span> phi {
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">typename</span> enable_if<span style="color:#333">&lt;</span>is_integral<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;::</span>value, <span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">int</span><span style="color:#333">&gt;::</span>type
</span></span><span style="display:flex;"><span>		enable_if_func(T val) {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">return</span> <span style="color:#00d;font-weight:bold">100</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">template</span><span style="color:#333">&lt;</span><span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">T</span><span style="color:#333">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#080;font-weight:bold">typename</span> enable_if<span style="color:#333">&lt;</span>is_floating_point<span style="color:#333">&lt;</span>T<span style="color:#333">&gt;::</span>value, <span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">double</span><span style="color:#333">&gt;::</span>type
</span></span><span style="display:flex;"><span>		enable_if_func(T val) {
</span></span><span style="display:flex;"><span>		<span style="color:#080;font-weight:bold">return</span> <span style="color:#60e;font-weight:bold">1.0f</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
</div>
<div class="tags">
<div class="taxosfloating_left">
<p>Tags</p>
</div>
<div class="termsfloating_right">
<p>
<a href="/tags/cpp/">cpp</a>
<a href="/tags/type-traits/">type-traits</a>
</p>
</div>
<div class="clearit"></div>
</div>
</article>
</div>
</main>
<footer>
© Copyright notice | <a href="https://github.com/dataCobra/hugo-vitae" target="_blank">Vitae</a> theme for <a href="https://gohugo.io" target="_blank">Hugo</a>
</footer><script src="/js/dark-mode.js"></script>

</body>
</html>
